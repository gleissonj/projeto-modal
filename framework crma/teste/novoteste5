# test_get_last_partition.py
import unittest
from unittest.mock import MagicMock
# ajuste o import abaixo para o nome do seu m√≥dulo
from main import get_last_partition

class TestGetLastPartition(unittest.TestCase):
    def test_varias_particoes_retorna_maior(self):
        glue_client = MagicMock()
        glue_client.get_partitions.return_value = {
            "Partitions": [
                {"Values": ["20240101"]},
                {"Values": ["20231231"]},
                {"Values": ["20240715"]},  # maior
            ]
        }

        result = get_last_partition(glue_client)
        self.assertEqual(result, 20240715)

    def test_uma_particao(self):
        glue_client = MagicMock()
        glue_client.get_partitions.return_value = {
            "Partitions": [{"Values": ["20240630"]}]
        }

        result = get_last_partition(glue_client)
        self.assertEqual(result, 20240630)

    def test_sem_particoes_retorna_vazio(self):
        glue_client = MagicMock()
        glue_client.get_partitions.return_value = {"Partitions": []}

        result = get_last_partition(glue_client)
        self.assertEqual(result, "")

if __name__ == "__main__":
    unittest.main()
