private static String buildQuery(Request req) {
    Map<String, String> fieldToValue = new Map<String, String>{
        'Name' => req.nomeContato,         // Corrigido para bater com sua classe real
        'Email__c' => null,                // Adicione mais campos se quiser
        'CPF__c' => null
    };

    List<String> conditions = new List<String>();

    for (String field : fieldToValue.keySet()) {
        String value = fieldToValue.get(field);
        if (!String.isBlank(value)) {
            // Escapa e for√ßa prefixo (mais seguro que '%'+var+'%')
            String escaped = String.escapeSingleQuotes(value);
            conditions.add(field + " LIKE '" + escaped + "%'");
        }
    }

    if (req.accountId != null) {
        conditions.add("AccountId__c = '" + String.escapeSingleQuotes(req.accountId) + "'");
    }

    if (conditions.isEmpty()) return null;

    String query = 'SELECT AccountId__c, Name, Email__c, CPF__c FROM AccountContactRelation__c WHERE ' +
                   String.join(conditions, ' AND ');

    return query;
}
