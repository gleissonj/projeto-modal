%dw 2.0
output application/java
---
payload map((item, index) -> {
    "FS1_DataValidacao__c": 
        (
            (item.dat_rfrc as String)
            // Truncate to milliseconds
            replace /(\.\d{3})\d+/ with "$1" // Keep first three digits after the decimal
            // Convert to DateTime with the correct format
            as DateTime {format: "yyyy-MM-dd HH:mm:ss.SSS"} 
            // Format to Salesforce ISO 8601 format
            as DateTime {format: "yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"}
        )
})
