import { LightningElement, track } from 'lwc';

export default class DatatableModal extends LightningElement {
    @track isDataTableModalOpen = false;
    @track isRowModalOpen = false;
    @track selectedRow = {};
    @track selectedRows = [];
    @track isConfirmButtonDisabled = true;

    data = [
        { id: '1', name: 'João' },
        { id: '2', name: 'Maria' },
        { id: '3', name: 'Carlos' }
    ];

    columns = [
        { label: 'ID', fieldName: 'id' },
        { label: 'Nome', fieldName: 'name' },
        { 
            type: 'button', 
            typeAttributes: { 
                label: 'Ver Detalhes', 
                name: 'view_details', 
                variant: 'brand-outline' 
            } 
        }
    ];

    get dataTableModalClass() {
        return this.isRowModalOpen ? 'modal-blur' : '';
    }

    openDataTableModal() {
        this.isDataTableModalOpen = true;
    }

    closeDataTableModal() {
        this.isDataTableModalOpen = false;
        this.isRowModalOpen = false; // Garante que o segundo modal também fecha
    }

    handleRowAction(event) {
        const row = event.detail.row;
        this.selectedRow = row;
        this.isRowModalOpen = true;
    }

    closeRowModal() {
        this.isRowModalOpen = false;
    }

    handleRowSelection(event) {
        this.selectedRows = event.detail.selectedRows;
        this.isConfirmButtonDisabled = this.selectedRows.length === 0;
    }

    handleConfirmSelection() {
        alert(`Selecionados: ${this.selectedRows.length} registros`);
        this.closeDataTableModal();
    }
}
