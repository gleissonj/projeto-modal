using System;
using System.Threading.Tasks;
using Amazon.Glue;
using Amazon.Glue.Model;
using Moq;
using Xunit;

public class GlueJobServiceTests
{
    [Fact]
    public async Task ExecutarJob_ReturnsDomainResponse_WithSuccessStatus()
    {
        // Arrange
        var jobName = "TestJob";
        var mockGlueClient = new Mock<AmazonGlueClient>(MockBehavior.Strict);
        var startJobRunResponse = new StartJobRunResponse();

        mockGlueClient.Setup(x => x.StartJobRunAsync(It.IsAny<StartJobRunRequest>(), default))
                      .ReturnsAsync(startJobRunResponse);

        // Replace the actual call with the mock
        var glueJobService = new GlueJobServiceMock(mockGlueClient.Object);

        // Act
        var result = await glueJobService.ExecutarJob(jobName);

        // Assert
        Assert.NotNull(result);
        Assert.Equal("O Servico iniciou", result.Status);
        mockGlueClient.Verify(x => x.StartJobRunAsync(It.Is<StartJobRunRequest>(r => r.JobName == jobName), default), Times.Once);
    }

    [Fact]
    public async Task ExecutarJob_InvalidJobName_ThrowsException
