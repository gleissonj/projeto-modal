@isTest
static void testProcessLeads() {

    // Step 1: Create a test user (using System.runAs to simulate the user)
    String uniqueUsername = 'testuser' + System.currentTimeMillis() + '@example.com'; // Make the username unique
    User testUser = new User(
        Username = uniqueUsername,
        Alias = 'testuser',
        Email = 'testuser@example.com',
        ProfileId = [SELECT Id FROM Profile WHERE Name = 'System Administrator' LIMIT 1].Id,
        TimeZoneSidKey = 'America/New_York',
        LocaleSidKey = 'en_US',
        EmailEncodingKey = 'UTF-8',
        LanguageLocaleKey = 'en_US'
    );
    insert testUser;

    // Step 2: Use System.runAs to simulate the test running as the test user
    System.runAs(testUser) {
        
        // Step 3: Create a test Account record
        Account testAccount = new Account(
            Name = 'Test Account', 
            OwnerId = testUser.Id
        );
        insert testAccount; // Insert to generate a valid ID and ensure access

        // Step 4: Create test data (Leads)
        Lead existingLead1 = new Lead(
            FirstName = 'John',
            LastName = 'Doe',
            HU7_CPF__c = '123.456.789-01',
            Prospect__c = testAccount.Id,  // Referencing the valid Account ID
            OwnerId = testUser.Id
        );
        insert existingLead1;

        Lead existingLead2 = new Lead(
            FirstName = 'Jane',
            LastName = 'Doe',
            HU7_CPF__c = '987.654.321-00',
            Prospect__c = testAccount.Id,  // Referencing the valid Account 
