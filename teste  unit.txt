import { createElement } from 'lwc';
import MyComponent from 'c/myComponent'; // Replace with your component's name
import { ShowToastEvent } from 'lightning/platformShowToastEvent';

describe('c-my-component', () => {
    it('should dispatch a success toast event with the correct message', () => {
        // Create a mock for ShowToastEvent
        const showToastEventSpy = jest.spyOn(window, 'ShowToastEvent').mockImplementation((eventDetail) => eventDetail);

        // Create the component
        const element = createElement('c-my-component', {
            is: MyComponent
        });

        // Append the component to the DOM
        document.body.appendChild(element);

        // Mock dispatchEvent to track dispatched events
        const dispatchEventSpy = jest.spyOn(element, 'dispatchEvent');

        // Call the showSuccessToast method
        const message = 'This is a success message!';
        element.showSuccessToast(message);

        // Check that dispatchEvent was called with a ShowToastEvent
        const expectedEventDetail = {
            title: 'Sucesso',
            message: message,
            variant: 'success'
        };
        const dispatchedEvent = dispatchEventSpy.mock.calls[0][0];
        expect(dispatchedEvent.detail).toEqual(expectedEventDetail);

        // Restore the original implementation
        showToastEventSpy.mockRestore();
    });
});
