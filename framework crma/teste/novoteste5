# test_get_last_partition.py
import unittest
from unittest.mock import MagicMock
# ajuste o import abaixo para o nome do seu módulo
from main import get_last_partition

class TestGetLastPartition(unittest.TestCase):
    def test_varias_particoes_retorna_maior(self):
        glue_client = MagicMock()
        glue_client.get_partitions.return_value = {
            "Partitions": [
                {"Values": ["20240101"]},
                {"Values": ["20231231"]},
                {"Values": ["20240715"]},  # maior
            ]
        }

        result = get_last_partition(glue_client)
        self.assertEqual(result, 20240715)

    def test_uma_particao(self):
        glue_client = MagicMock()
        glue_client.get_partitions.return_value = {
            "Partitions": [{"Values": ["20240630"]}]
        }

        result = get_last_partition(glue_client)
        self.assertEqual(result, 20240630)

    def test_sem_particoes_retorna_vazio(self):
        glue_client = MagicMock()
        glue_client.get_partitions.return_value = {"Partitions": []}

        result = get_last_partition(glue_client)
        self.assertEqual(result, "")

if __name__ == "__main__":
    unittest.main()



- bom tive umas agendas com o talles e o Rodrigo sobre a realização de cargas de dados de uma nova funcionalidade q eles vao inciar o desenvolvimento 
- recebemos um email q possuímos um glue q esta com template legado, e q precisamos atualizar para o novo o qto antes, então puxei essa demanda 
- sobre a reunião com o time do cbo, tentei marcar para hoje mas foi cancelada por eles, e remarcada para segunda feira, pq eles atendem só duas vezes na semana
- hoje vou atuar nessa migração do glue job para o novo template
- em paralelo peguei tbm a demanda pra inciar dos Jobs q estão rodando na codepipeline para a iupies

