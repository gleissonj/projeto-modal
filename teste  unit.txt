import { createElement } from 'lwc';
import MyComponent from 'c/myComponent'; // Replace with your component's name

describe('c-my-component', () => {
    it('should dispatch a success toast event with the correct message', () => {
        // Mock ShowToastEvent
        const ShowToastEventMock = jest.fn();
        globalThis.ShowToastEvent = ShowToastEventMock;

        // Create the component
        const element = createElement('c-my-component', {
            is: MyComponent
        });

        // Append the component to the DOM
        document.body.appendChild(element);

        // Mock dispatchEvent to track dispatched events
        const dispatchEventSpy = jest.spyOn(element, 'dispatchEvent');

        // Call the showSuccessToast method
        const message = 'This is a success message!';
        element.showSuccessToast(message);

        // Check that dispatchEvent was called with a ShowToastEvent
        const expectedEventDetail = {
            title: 'Sucesso',
            message: message,
            variant: 'success'
        };
        const dispatchedEvent = dispatchEventSpy.mock.calls[0][0];
        expect(ShowToastEventMock).toHaveBeenCalledWith(expectedEventDetail);
        expect(dispatchedEvent.detail).toEqual(expectedEventDetail);

        // Cleanup
        delete globalThis.ShowToastEvent;
    });
});
